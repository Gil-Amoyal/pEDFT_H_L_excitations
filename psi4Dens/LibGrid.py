import numpy as np
from numpy.polynomial.legendre import leggauss

Leb9_Str = """
   0.000000000000000    90.000000000000000     0.009523809523810
 180.000000000000000    90.000000000000000     0.009523809523810
  90.000000000000000    90.000000000000000     0.009523809523810
 -90.000000000000000    90.000000000000000     0.009523809523810
  90.000000000000000     0.000000000000000     0.009523809523810
  90.000000000000000   180.000000000000000     0.009523809523810
  45.000000000000000    54.735610317245346     0.032142857142857
  45.000000000000000   125.264389682754654     0.032142857142857
 -45.000000000000000    54.735610317245346     0.032142857142857
 -45.000000000000000   125.264389682754654     0.032142857142857
 135.000000000000000    54.735610317245346     0.032142857142857
 135.000000000000000   125.264389682754654     0.032142857142857
-135.000000000000000    54.735610317245346     0.032142857142857
-135.000000000000000   125.264389682754654     0.032142857142857
  62.632194841377327    90.000000000000000     0.028571428571429
 -62.632194841377327    90.000000000000000     0.028571428571429
 117.367805158622687    90.000000000000000     0.028571428571429
-117.367805158622687    90.000000000000000     0.028571428571429
  27.367805158622673    90.000000000000000     0.028571428571429
 -27.367805158622673    90.000000000000000     0.028571428571429
 152.632194841377355    90.000000000000000     0.028571428571429
-152.632194841377355    90.000000000000000     0.028571428571429
   0.000000000000000    27.367805158622673     0.028571428571429
   0.000000000000000   152.632194841377355     0.028571428571429
 180.000000000000000    27.367805158622673     0.028571428571429
 180.000000000000000   152.632194841377355     0.028571428571429
   0.000000000000000    62.632194841377327     0.028571428571429
   0.000000000000000   117.367805158622687     0.028571428571429
 180.000000000000000    62.632194841377327     0.028571428571429
 180.000000000000000   117.367805158622687     0.028571428571429
  90.000000000000000    27.367805158622673     0.028571428571429
  90.000000000000000   152.632194841377355     0.028571428571429
 -90.000000000000000    27.367805158622673     0.028571428571429
 -90.000000000000000   152.632194841377355     0.028571428571429
  90.000000000000000    62.632194841377327     0.028571428571429
  90.000000000000000   117.367805158622687     0.028571428571429
 -90.000000000000000    62.632194841377327     0.028571428571429
 -90.000000000000000   117.367805158622687     0.028571428571429
"""

Leb25_Str = """
   0.000000000000000    90.000000000000000    -0.055226399197273
 180.000000000000000    90.000000000000000    -0.055226399197273
  90.000000000000000    90.000000000000000    -0.055226399197273
 -90.000000000000000    90.000000000000000    -0.055226399197273
  90.000000000000000     0.000000000000000    -0.055226399197273
  90.000000000000000   180.000000000000000    -0.055226399197273
  45.000000000000000    54.735610317245346     0.004450274607445
  45.000000000000000   125.264389682754654     0.004450274607445
 -45.000000000000000    54.735610317245346     0.004450274607445
 -45.000000000000000   125.264389682754654     0.004450274607445
 135.000000000000000    54.735610317245346     0.004450274607445
 135.000000000000000   125.264389682754654     0.004450274607445
-135.000000000000000    54.735610317245346     0.004450274607445
-135.000000000000000   125.264389682754654     0.004450274607445
  45.000000000000000    39.440090784780402     0.004496841067921
  45.000000000000000   140.559909215219591     0.004496841067921
 -45.000000000000000    39.440090784780402     0.004496841067921
 -45.000000000000000   140.559909215219591     0.004496841067921
 135.000000000000000    39.440090784780402     0.004496841067921
 135.000000000000000   140.559909215219591     0.004496841067921
-135.000000000000000    39.440090784780402     0.004496841067921
-135.000000000000000   140.559909215219591     0.004496841067921
  59.815442273124063    63.307345060625650     0.004496841067921
 -59.815442273124063    63.307345060625650     0.004496841067921
  59.815442273124063   116.692654939374364     0.004496841067921
 -59.815442273124063   116.692654939374364     0.004496841067921
 120.184557726875937    63.307345060625650     0.004496841067921
-120.184557726875937    63.307345060625650     0.004496841067921
 120.184557726875937   116.692654939374364     0.004496841067921
-120.184557726875937   116.692654939374364     0.004496841067921
  30.184557726875941    63.307345060625650     0.004496841067921
 149.815442273124063    63.307345060625650     0.004496841067921
  30.184557726875941   116.692654939374364     0.004496841067921
 149.815442273124063   116.692654939374364     0.004496841067921
 -30.184557726875941    63.307345060625650     0.004496841067921
-149.815442273124063    63.307345060625650     0.004496841067921
 -30.184557726875941   116.692654939374364     0.004496841067921
-149.815442273124063   116.692654939374364     0.004496841067921
  45.000000000000000    20.881794557261646     0.005049153450479
  45.000000000000000   159.118205442738343     0.005049153450479
 -45.000000000000000    20.881794557261646     0.005049153450479
 -45.000000000000000   159.118205442738343     0.005049153450479
 135.000000000000000    20.881794557261646     0.005049153450479
 135.000000000000000   159.118205442738343     0.005049153450479
-135.000000000000000    20.881794557261646     0.005049153450479
-135.000000000000000   159.118205442738343     0.005049153450479
  74.903220296612005    75.401622829462283     0.005049153450479
 -74.903220296612005    75.401622829462283     0.005049153450479
  74.903220296612005   104.598377170537717     0.005049153450479
 -74.903220296612005   104.598377170537717     0.005049153450479
 105.096779703387995    75.401622829462283     0.005049153450479
-105.096779703387995    75.401622829462283     0.005049153450479
 105.096779703387995   104.598377170537717     0.005049153450479
-105.096779703387995   104.598377170537717     0.005049153450479
  15.096779703387996    75.401622829462283     0.005049153450479
 164.903220296612034    75.401622829462283     0.005049153450479
  15.096779703387996   104.598377170537717     0.005049153450479
 164.903220296612034   104.598377170537717     0.005049153450479
 -15.096779703387996    75.401622829462283     0.005049153450479
-164.903220296612034    75.401622829462283     0.005049153450479
 -15.096779703387996   104.598377170537717     0.005049153450479
-164.903220296612034   104.598377170537717     0.005049153450479
  45.000000000000000    80.891636123006165     0.003976408018052
  45.000000000000000    99.108363876993835     0.003976408018052
 -45.000000000000000    80.891636123006165     0.003976408018052
 -45.000000000000000    99.108363876993835     0.003976408018052
 135.000000000000000    80.891636123006165     0.003976408018052
 135.000000000000000    99.108363876993835     0.003976408018052
-135.000000000000000    80.891636123006165     0.003976408018052
-135.000000000000000    99.108363876993835     0.003976408018052
  12.774805990014807    45.717979481517574     0.003976408018052
 -12.774805990014807    45.717979481517574     0.003976408018052
  12.774805990014807   134.282020518482426     0.003976408018052
 -12.774805990014807   134.282020518482426     0.003976408018052
 167.225194009985188    45.717979481517574     0.003976408018052
-167.225194009985188    45.717979481517574     0.003976408018052
 167.225194009985188   134.282020518482426     0.003976408018052
-167.225194009985188   134.282020518482426     0.003976408018052
  77.225194009985188    45.717979481517574     0.003976408018052
 102.774805990014812    45.717979481517574     0.003976408018052
  77.225194009985188   134.282020518482426     0.003976408018052
 102.774805990014812   134.282020518482426     0.003976408018052
 -77.225194009985188    45.717979481517574     0.003976408018052
-102.774805990014812    45.717979481517574     0.003976408018052
 -77.225194009985188   134.282020518482426     0.003976408018052
-102.774805990014812   134.282020518482426     0.003976408018052
  45.000000000000000    68.685581154790029     0.004401400650381
  45.000000000000000   111.314418845209985     0.004401400650381
 -45.000000000000000    68.685581154790029     0.004401400650381
 -45.000000000000000   111.314418845209985     0.004401400650381
 135.000000000000000    68.685581154790029     0.004401400650381
 135.000000000000000   111.314418845209985     0.004401400650381
-135.000000000000000    68.685581154790029     0.004401400650381
-135.000000000000000   111.314418845209985     0.004401400650381
  28.889424740291254    48.796111385350962     0.004401400650381
 -28.889424740291254    48.796111385350962     0.004401400650381
  28.889424740291254   131.203888614649060     0.004401400650381
 -28.889424740291254   131.203888614649060     0.004401400650381
 151.110575259708753    48.796111385350962     0.004401400650381
-151.110575259708753    48.796111385350962     0.004401400650381
 151.110575259708753   131.203888614649060     0.004401400650381
-151.110575259708753   131.203888614649060     0.004401400650381
  61.110575259708753    48.796111385350962     0.004401400650381
 118.889424740291247    48.796111385350962     0.004401400650381
  61.110575259708753   131.203888614649060     0.004401400650381
 118.889424740291247   131.203888614649060     0.004401400650381
 -61.110575259708753    48.796111385350962     0.004401400650381
-118.889424740291247    48.796111385350962     0.004401400650381
 -61.110575259708753   131.203888614649060     0.004401400650381
-118.889424740291247   131.203888614649060     0.004401400650381
  45.000000000000000     3.274152069216487     0.017245443505444
  45.000000000000000   176.725847930783516     0.017245443505444
 -45.000000000000000     3.274152069216487     0.017245443505444
 -45.000000000000000   176.725847930783516     0.017245443505444
 135.000000000000000     3.274152069216487     0.017245443505444
 135.000000000000000   176.725847930783516     0.017245443505444
-135.000000000000000     3.274152069216487     0.017245443505444
-135.000000000000000   176.725847930783516     0.017245443505444
  87.683564415961172    87.685455250362111     0.017245443505444
 -87.683564415961172    87.685455250362111     0.017245443505444
  87.683564415961172    92.314544749637903     0.017245443505444
 -87.683564415961172    92.314544749637903     0.017245443505444
  92.316435584038842    87.685455250362111     0.017245443505444
 -92.316435584038842    87.685455250362111     0.017245443505444
  92.316435584038842    92.314544749637903     0.017245443505444
 -92.316435584038842    92.314544749637903     0.017245443505444
   2.316435584038771    87.685455250362111     0.017245443505444
 177.683564415961257    87.685455250362111     0.017245443505444
   2.316435584038771    92.314544749637903     0.017245443505444
 177.683564415961257    92.314544749637903     0.017245443505444
  -2.316435584038771    87.685455250362111     0.017245443505444
-177.683564415961257    87.685455250362111     0.017245443505444
  -2.316435584038771    92.314544749637903     0.017245443505444
-177.683564415961257    92.314544749637903     0.017245443505444
  54.381587934584054    90.000000000000000     0.004231083095357
 -54.381587934584054    90.000000000000000     0.004231083095357
 125.618412065415953    90.000000000000000     0.004231083095357
-125.618412065415953    90.000000000000000     0.004231083095357
  35.618412065415953    90.000000000000000     0.004231083095357
 -35.618412065415953    90.000000000000000     0.004231083095357
 144.381587934584047    90.000000000000000     0.004231083095357
-144.381587934584047    90.000000000000000     0.004231083095357
   0.000000000000000    35.618412065415953     0.004231083095357
   0.000000000000000   144.381587934584047     0.004231083095357
 180.000000000000000    35.618412065415953     0.004231083095357
 180.000000000000000   144.381587934584047     0.004231083095357
   0.000000000000000    54.381587934584054     0.004231083095357
   0.000000000000000   125.618412065415953     0.004231083095357
 180.000000000000000    54.381587934584054     0.004231083095357
 180.000000000000000   125.618412065415953     0.004231083095357
  90.000000000000000    35.618412065415953     0.004231083095357
  90.000000000000000   144.381587934584047     0.004231083095357
 -90.000000000000000    35.618412065415953     0.004231083095357
 -90.000000000000000   144.381587934584047     0.004231083095357
  90.000000000000000    54.381587934584054     0.004231083095357
  90.000000000000000   125.618412065415953     0.004231083095357
 -90.000000000000000    54.381587934584054     0.004231083095357
 -90.000000000000000   125.618412065415953     0.004231083095357
  69.231820019013028    90.000000000000000     0.005198069864064
 -69.231820019013028    90.000000000000000     0.005198069864064
 110.768179980986986    90.000000000000000     0.005198069864064
-110.768179980986986    90.000000000000000     0.005198069864064
  20.768179980986979    90.000000000000000     0.005198069864064
 -20.768179980986979    90.000000000000000     0.005198069864064
 159.231820019013014    90.000000000000000     0.005198069864064
-159.231820019013014    90.000000000000000     0.005198069864064
   0.000000000000000    20.768179980986979     0.005198069864064
   0.000000000000000   159.231820019013014     0.005198069864064
 180.000000000000000    20.768179980986979     0.005198069864064
 180.000000000000000   159.231820019013014     0.005198069864064
   0.000000000000000    69.231820019013028     0.005198069864064
   0.000000000000000   110.768179980986986     0.005198069864064
 180.000000000000000    69.231820019013028     0.005198069864064
 180.000000000000000   110.768179980986986     0.005198069864064
  90.000000000000000    20.768179980986979     0.005198069864064
  90.000000000000000   159.231820019013014     0.005198069864064
 -90.000000000000000    20.768179980986979     0.005198069864064
 -90.000000000000000   159.231820019013014     0.005198069864064
  90.000000000000000    69.231820019013028     0.005198069864064
  90.000000000000000   110.768179980986986     0.005198069864064
 -90.000000000000000    69.231820019013028     0.005198069864064
 -90.000000000000000   110.768179980986986     0.005198069864064
  64.963704081332708    32.473856655655446     0.004695720972569
  64.963704081332708   147.526143344344547     0.004695720972569
 -64.963704081332708    32.473856655655446     0.004695720972569
 -64.963704081332708   147.526143344344547     0.004695720972569
 115.036295918667292    32.473856655655446     0.004695720972569
 115.036295918667292   147.526143344344547     0.004695720972569
-115.036295918667292    32.473856655655446     0.004695720972569
-115.036295918667292   147.526143344344547     0.004695720972569
  74.926112157973748    60.891424466952714     0.004695720972569
  74.926112157973748   119.108575533047286     0.004695720972569
 -74.926112157973748    60.891424466952714     0.004695720972569
 -74.926112157973748   119.108575533047286     0.004695720972569
 105.073887842026252    60.891424466952714     0.004695720972569
 105.073887842026252   119.108575533047286     0.004695720972569
-105.073887842026252    60.891424466952714     0.004695720972569
-105.073887842026252   119.108575533047286     0.004695720972569
  25.036295918667289    32.473856655655446     0.004695720972569
  25.036295918667289   147.526143344344547     0.004695720972569
 -25.036295918667289    32.473856655655446     0.004695720972569
 -25.036295918667289   147.526143344344547     0.004695720972569
 154.963704081332708    32.473856655655446     0.004695720972569
 154.963704081332708   147.526143344344547     0.004695720972569
-154.963704081332708    32.473856655655446     0.004695720972569
-154.963704081332708   147.526143344344547     0.004695720972569
  60.030959593932515    76.866650451671518     0.004695720972569
  60.030959593932515   103.133349548328482     0.004695720972569
 -60.030959593932515    76.866650451671518     0.004695720972569
 -60.030959593932515   103.133349548328482     0.004695720972569
 119.969040406067492    76.866650451671518     0.004695720972569
 119.969040406067492   103.133349548328482     0.004695720972569
-119.969040406067492    76.866650451671518     0.004695720972569
-119.969040406067492   103.133349548328482     0.004695720972569
  15.073887842026251    60.891424466952714     0.004695720972569
  15.073887842026251   119.108575533047286     0.004695720972569
 -15.073887842026251    60.891424466952714     0.004695720972569
 -15.073887842026251   119.108575533047286     0.004695720972569
 164.926112157973762    60.891424466952714     0.004695720972569
 164.926112157973762   119.108575533047286     0.004695720972569
-164.926112157973762    60.891424466952714     0.004695720972569
-164.926112157973762   119.108575533047286     0.004695720972569
  29.969040406067499    76.866650451671518     0.004695720972569
  29.969040406067499   103.133349548328482     0.004695720972569
 -29.969040406067499    76.866650451671518     0.004695720972569
 -29.969040406067499   103.133349548328482     0.004695720972569
 150.030959593932522    76.866650451671518     0.004695720972569
 150.030959593932522   103.133349548328482     0.004695720972569
-150.030959593932522    76.866650451671518     0.004695720972569
-150.030959593932522   103.133349548328482     0.004695720972569
"""
Leb41_Str = """
   0.000000000000000    90.000000000000000     0.000309512129531
 180.000000000000000    90.000000000000000     0.000309512129531
  90.000000000000000    90.000000000000000     0.000309512129531
 -90.000000000000000    90.000000000000000     0.000309512129531
  90.000000000000000     0.000000000000000     0.000309512129531
  90.000000000000000   180.000000000000000     0.000309512129531
  45.000000000000000    54.735610317245346     0.001852379698597
  45.000000000000000   125.264389682754654     0.001852379698597
 -45.000000000000000    54.735610317245346     0.001852379698597
 -45.000000000000000   125.264389682754654     0.001852379698597
 135.000000000000000    54.735610317245346     0.001852379698597
 135.000000000000000   125.264389682754654     0.001852379698597
-135.000000000000000    54.735610317245346     0.001852379698597
-135.000000000000000   125.264389682754654     0.001852379698597
  45.000000000000000    84.710367813674395     0.001871790639278
  45.000000000000000    95.289632186325619     0.001871790639278
 -45.000000000000000    84.710367813674395     0.001871790639278
 -45.000000000000000    95.289632186325619     0.001871790639278
 135.000000000000000    84.710367813674395     0.001871790639278
 135.000000000000000    95.289632186325619     0.001871790639278
-135.000000000000000    84.710367813674395     0.001871790639278
-135.000000000000000    95.289632186325619     0.001871790639278
   7.459560144595610    45.243483384903868     0.001871790639278
  -7.459560144595610    45.243483384903868     0.001871790639278
   7.459560144595610   134.756516615096160     0.001871790639278
  -7.459560144595610   134.756516615096160     0.001871790639278
 172.540439855404401    45.243483384903868     0.001871790639278
-172.540439855404401    45.243483384903868     0.001871790639278
 172.540439855404401   134.756516615096160     0.001871790639278
-172.540439855404401   134.756516615096160     0.001871790639278
  82.540439855404415    45.243483384903868     0.001871790639278
  97.459560144595599    45.243483384903868     0.001871790639278
  82.540439855404415   134.756516615096160     0.001871790639278
  97.459560144595599   134.756516615096160     0.001871790639278
 -82.540439855404415    45.243483384903868     0.001871790639278
 -97.459560144595599    45.243483384903868     0.001871790639278
 -82.540439855404415   134.756516615096160     0.001871790639278
 -97.459560144595599   134.756516615096160     0.001871790639278
  45.000000000000000    74.314542724511028     0.001858812585438
  45.000000000000000   105.685457275488972     0.001858812585438
 -45.000000000000000    74.314542724511028     0.001858812585438
 -45.000000000000000   105.685457275488972     0.001858812585438
 135.000000000000000    74.314542724511028     0.001858812585438
 135.000000000000000   105.685457275488972     0.001858812585438
-135.000000000000000    74.314542724511028     0.001858812585438
-135.000000000000000   105.685457275488972     0.001858812585438
  21.659522462142391    47.095812412261942     0.001858812585438
 -21.659522462142391    47.095812412261942     0.001858812585438
  21.659522462142391   132.904187587738079     0.001858812585438
 -21.659522462142391   132.904187587738079     0.001858812585438
 158.340477537857623    47.095812412261942     0.001858812585438
-158.340477537857623    47.095812412261942     0.001858812585438
 158.340477537857623   132.904187587738079     0.001858812585438
-158.340477537857623   132.904187587738079     0.001858812585438
  68.340477537857609    47.095812412261942     0.001858812585438
 111.659522462142391    47.095812412261942     0.001858812585438
  68.340477537857609   132.904187587738079     0.001858812585438
 111.659522462142391   132.904187587738079     0.001858812585438
 -68.340477537857609    47.095812412261942     0.001858812585438
-111.659522462142391    47.095812412261942     0.001858812585438
 -68.340477537857609   132.904187587738079     0.001858812585438
-111.659522462142391   132.904187587738079     0.001858812585438
  45.000000000000000    64.318134318778689     0.001852028828296
  45.000000000000000   115.681865681221325     0.001852028828296
 -45.000000000000000    64.318134318778689     0.001852028828296
 -45.000000000000000   115.681865681221325     0.001852028828296
 135.000000000000000    64.318134318778689     0.001852028828296
 135.000000000000000   115.681865681221325     0.001852028828296
-135.000000000000000    64.318134318778689     0.001852028828296
-135.000000000000000   115.681865681221325     0.001852028828296
  34.218202929491348    50.412587784704165     0.001852028828296
 -34.218202929491348    50.412587784704165     0.001852028828296
  34.218202929491348   129.587412215295842     0.001852028828296
 -34.218202929491348   129.587412215295842     0.001852028828296
 145.781797070508645    50.412587784704165     0.001852028828296
-145.781797070508645    50.412587784704165     0.001852028828296
 145.781797070508645   129.587412215295842     0.001852028828296
-145.781797070508645   129.587412215295842     0.001852028828296
  55.781797070508652    50.412587784704165     0.001852028828296
 124.218202929491355    50.412587784704165     0.001852028828296
  55.781797070508652   129.587412215295842     0.001852028828296
 124.218202929491355   129.587412215295842     0.001852028828296
 -55.781797070508652    50.412587784704165     0.001852028828296
-124.218202929491355    50.412587784704165     0.001852028828296
 -55.781797070508652   129.587412215295842     0.001852028828296
-124.218202929491355   129.587412215295842     0.001852028828296
  45.000000000000000    45.511300519562141     0.001846715956151
  45.000000000000000   134.488699480437873     0.001846715956151
 -45.000000000000000    45.511300519562141     0.001846715956151
 -45.000000000000000   134.488699480437873     0.001846715956151
 135.000000000000000    45.511300519562141     0.001846715956151
 135.000000000000000   134.488699480437873     0.001846715956151
-135.000000000000000    45.511300519562141     0.001846715956151
-135.000000000000000   134.488699480437873     0.001846715956151
  54.252111945679047    59.705683855068237     0.001846715956151
 -54.252111945679047    59.705683855068237     0.001846715956151
  54.252111945679047   120.294316144931756     0.001846715956151
 -54.252111945679047   120.294316144931756     0.001846715956151
 125.747888054320953    59.705683855068237     0.001846715956151
-125.747888054320953    59.705683855068237     0.001846715956151
 125.747888054320953   120.294316144931756     0.001846715956151
-125.747888054320953   120.294316144931756     0.001846715956151
  35.747888054320953    59.705683855068237     0.001846715956151
 144.252111945679076    59.705683855068237     0.001846715956151
  35.747888054320953   120.294316144931756     0.001846715956151
 144.252111945679076   120.294316144931756     0.001846715956151
 -35.747888054320953    59.705683855068237     0.001846715956151
-144.252111945679076    59.705683855068237     0.001846715956151
 -35.747888054320953   120.294316144931756     0.001846715956151
-144.252111945679076   120.294316144931756     0.001846715956151
  45.000000000000000    36.598135459661613     0.001818471778163
  45.000000000000000   143.401864540338408     0.001818471778163
 -45.000000000000000    36.598135459661613     0.001818471778163
 -45.000000000000000   143.401864540338408     0.001818471778163
 135.000000000000000    36.598135459661613     0.001818471778163
 135.000000000000000   143.401864540338408     0.001818471778163
-135.000000000000000    36.598135459661613     0.001818471778163
-135.000000000000000   143.401864540338408     0.001818471778163
  62.295670263057389    65.065861723141154     0.001818471778163
 -62.295670263057389    65.065861723141154     0.001818471778163
  62.295670263057389   114.934138276858846     0.001818471778163
 -62.295670263057389   114.934138276858846     0.001818471778163
 117.704329736942611    65.065861723141154     0.001818471778163
-117.704329736942611    65.065861723141154     0.001818471778163
 117.704329736942611   114.934138276858846     0.001818471778163
-117.704329736942611   114.934138276858846     0.001818471778163
  27.704329736942618    65.065861723141154     0.001818471778163
 152.295670263057389    65.065861723141154     0.001818471778163
  27.704329736942618   114.934138276858846     0.001818471778163
 152.295670263057389   114.934138276858846     0.001818471778163
 -27.704329736942618    65.065861723141154     0.001818471778163
-152.295670263057389    65.065861723141154     0.001818471778163
 -27.704329736942618   114.934138276858846     0.001818471778163
-152.295670263057389   114.934138276858846     0.001818471778163
  45.000000000000000    27.983991658643468     0.001749564657281
  45.000000000000000   152.016008341356553     0.001749564657281
 -45.000000000000000    27.983991658643468     0.001749564657281
 -45.000000000000000   152.016008341356553     0.001749564657281
 135.000000000000000    27.983991658643468     0.001749564657281
 135.000000000000000   152.016008341356553     0.001749564657281
-135.000000000000000    27.983991658643468     0.001749564657281
-135.000000000000000   152.016008341356553     0.001749564657281
  69.407697777482170    70.622416788971051     0.001749564657281
 -69.407697777482170    70.622416788971051     0.001749564657281
  69.407697777482170   109.377583211028949     0.001749564657281
 -69.407697777482170   109.377583211028949     0.001749564657281
 110.592302222517830    70.622416788971051     0.001749564657281
-110.592302222517830    70.622416788971051     0.001749564657281
 110.592302222517830   109.377583211028949     0.001749564657281
-110.592302222517830   109.377583211028949     0.001749564657281
  20.592302222517837    70.622416788971051     0.001749564657281
 159.407697777482184    70.622416788971051     0.001749564657281
  20.592302222517837   109.377583211028949     0.001749564657281
 159.407697777482184   109.377583211028949     0.001749564657281
 -20.592302222517837    70.622416788971051     0.001749564657281
-159.407697777482184    70.622416788971051     0.001749564657281
 -20.592302222517837   109.377583211028949     0.001749564657281
-159.407697777482184   109.377583211028949     0.001749564657281
  45.000000000000000    19.709581740941708     0.001617210647254
  45.000000000000000   160.290418259058299     0.001617210647254
 -45.000000000000000    19.709581740941708     0.001617210647254
 -45.000000000000000   160.290418259058299     0.001617210647254
 135.000000000000000    19.709581740941708     0.001617210647254
 135.000000000000000   160.290418259058299     0.001617210647254
-135.000000000000000    19.709581740941708     0.001617210647254
-135.000000000000000   160.290418259058299     0.001617210647254
  75.785171199711186    76.203527361711352     0.001617210647254
 -75.785171199711186    76.203527361711352     0.001617210647254
  75.785171199711186   103.796472638288662     0.001617210647254
 -75.785171199711186   103.796472638288662     0.001617210647254
 104.214828800288828    76.203527361711352     0.001617210647254
-104.214828800288828    76.203527361711352     0.001617210647254
 104.214828800288828   103.796472638288662     0.001617210647254
-104.214828800288828   103.796472638288662     0.001617210647254
  14.214828800288812    76.203527361711352     0.001617210647254
 165.785171199711186    76.203527361711352     0.001617210647254
  14.214828800288812   103.796472638288662     0.001617210647254
 165.785171199711186   103.796472638288662     0.001617210647254
 -14.214828800288812    76.203527361711352     0.001617210647254
-165.785171199711186    76.203527361711352     0.001617210647254
 -14.214828800288812   103.796472638288662     0.001617210647254
-165.785171199711186   103.796472638288662     0.001617210647254
  45.000000000000000    11.907889002938523     0.001384737234852
  45.000000000000000   168.092110997061468     0.001384737234852
 -45.000000000000000    11.907889002938523     0.001384737234852
 -45.000000000000000   168.092110997061468     0.001384737234852
 135.000000000000000    11.907889002938523     0.001384737234852
 135.000000000000000   168.092110997061468     0.001384737234852
-135.000000000000000    11.907889002938523     0.001384737234852
-135.000000000000000   168.092110997061468     0.001384737234852
  81.518974264782287    81.610389240637687     0.001384737234852
 -81.518974264782287    81.610389240637687     0.001384737234852
  81.518974264782287    98.389610759362313     0.001384737234852
 -81.518974264782287    98.389610759362313     0.001384737234852
  98.481025735217713    81.610389240637687     0.001384737234852
 -98.481025735217713    81.610389240637687     0.001384737234852
  98.481025735217713    98.389610759362313     0.001384737234852
 -98.481025735217713    98.389610759362313     0.001384737234852
   8.481025735217729    81.610389240637687     0.001384737234852
 171.518974264782287    81.610389240637687     0.001384737234852
   8.481025735217729    98.389610759362313     0.001384737234852
 171.518974264782287    98.389610759362313     0.001384737234852
  -8.481025735217729    81.610389240637687     0.001384737234852
-171.518974264782287    81.610389240637687     0.001384737234852
  -8.481025735217729    98.389610759362313     0.001384737234852
-171.518974264782287    98.389610759362313     0.001384737234852
  45.000000000000000     4.944849014545264     0.000976433116505
  45.000000000000000   175.055150985454759     0.000976433116505
 -45.000000000000000     4.944849014545264     0.000976433116505
 -45.000000000000000   175.055150985454759     0.000976433116505
 135.000000000000000     4.944849014545264     0.000976433116505
 135.000000000000000   175.055150985454759     0.000976433116505
-135.000000000000000     4.944849014545264     0.000976433116505
-135.000000000000000   175.055150985454759     0.000976433116505
  86.499119922597842    86.505636849659055     0.000976433116505
 -86.499119922597842    86.505636849659055     0.000976433116505
  86.499119922597842    93.494363150340945     0.000976433116505
 -86.499119922597842    93.494363150340945     0.000976433116505
  93.500880077402172    86.505636849659055     0.000976433116505
 -93.500880077402172    86.505636849659055     0.000976433116505
  93.500880077402172    93.494363150340945     0.000976433116505
 -93.500880077402172    93.494363150340945     0.000976433116505
   3.500880077402161    86.505636849659055     0.000976433116505
 176.499119922597828    86.505636849659055     0.000976433116505
   3.500880077402161    93.494363150340945     0.000976433116505
 176.499119922597828    93.494363150340945     0.000976433116505
  -3.500880077402161    86.505636849659055     0.000976433116505
-176.499119922597828    86.505636849659055     0.000976433116505
  -3.500880077402161    93.494363150340945     0.000976433116505
-176.499119922597828    93.494363150340945     0.000976433116505
  52.288608088092758    90.000000000000000     0.001857161196774
 -52.288608088092758    90.000000000000000     0.001857161196774
 127.711391911907242    90.000000000000000     0.001857161196774
-127.711391911907242    90.000000000000000     0.001857161196774
  37.711391911907242    90.000000000000000     0.001857161196774
 -37.711391911907242    90.000000000000000     0.001857161196774
 142.288608088092758    90.000000000000000     0.001857161196774
-142.288608088092758    90.000000000000000     0.001857161196774
   0.000000000000000    37.711391911907242     0.001857161196774
   0.000000000000000   142.288608088092758     0.001857161196774
 180.000000000000000    37.711391911907242     0.001857161196774
 180.000000000000000   142.288608088092758     0.001857161196774
   0.000000000000000    52.288608088092758     0.001857161196774
   0.000000000000000   127.711391911907242     0.001857161196774
 180.000000000000000    52.288608088092758     0.001857161196774
 180.000000000000000   127.711391911907242     0.001857161196774
  90.000000000000000    37.711391911907242     0.001857161196774
  90.000000000000000   142.288608088092758     0.001857161196774
 -90.000000000000000    37.711391911907242     0.001857161196774
 -90.000000000000000   142.288608088092758     0.001857161196774
  90.000000000000000    52.288608088092758     0.001857161196774
  90.000000000000000   127.711391911907242     0.001857161196774
 -90.000000000000000    52.288608088092758     0.001857161196774
 -90.000000000000000   127.711391911907242     0.001857161196774
  66.641968788118220    90.000000000000000     0.001705153996396
 -66.641968788118220    90.000000000000000     0.001705153996396
 113.358031211881794    90.000000000000000     0.001705153996396
-113.358031211881794    90.000000000000000     0.001705153996396
  23.358031211881791    90.000000000000000     0.001705153996396
 -23.358031211881791    90.000000000000000     0.001705153996396
 156.641968788118220    90.000000000000000     0.001705153996396
-156.641968788118220    90.000000000000000     0.001705153996396
   0.000000000000000    23.358031211881791     0.001705153996396
   0.000000000000000   156.641968788118220     0.001705153996396
 180.000000000000000    23.358031211881791     0.001705153996396
 180.000000000000000   156.641968788118220     0.001705153996396
   0.000000000000000    66.641968788118220     0.001705153996396
   0.000000000000000   113.358031211881794     0.001705153996396
 180.000000000000000    66.641968788118220     0.001705153996396
 180.000000000000000   113.358031211881794     0.001705153996396
  90.000000000000000    23.358031211881791     0.001705153996396
  90.000000000000000   156.641968788118220     0.001705153996396
 -90.000000000000000    23.358031211881791     0.001705153996396
 -90.000000000000000   156.641968788118220     0.001705153996396
  90.000000000000000    66.641968788118220     0.001705153996396
  90.000000000000000   113.358031211881794     0.001705153996396
 -90.000000000000000    66.641968788118220     0.001705153996396
 -90.000000000000000   113.358031211881794     0.001705153996396
  80.068061732303320    90.000000000000000     0.001300321685886
 -80.068061732303320    90.000000000000000     0.001300321685886
  99.931938267696694    90.000000000000000     0.001300321685886
 -99.931938267696694    90.000000000000000     0.001300321685886
   9.931938267696671    90.000000000000000     0.001300321685886
  -9.931938267696671    90.000000000000000     0.001300321685886
 170.068061732303335    90.000000000000000     0.001300321685886
-170.068061732303335    90.000000000000000     0.001300321685886
   0.000000000000000     9.931938267696671     0.001300321685886
   0.000000000000000   170.068061732303335     0.001300321685886
 180.000000000000000     9.931938267696671     0.001300321685886
 180.000000000000000   170.068061732303335     0.001300321685886
   0.000000000000000    80.068061732303320     0.001300321685886
   0.000000000000000    99.931938267696694     0.001300321685886
 180.000000000000000    80.068061732303320     0.001300321685886
 180.000000000000000    99.931938267696694     0.001300321685886
  90.000000000000000     9.931938267696671     0.001300321685886
  90.000000000000000   170.068061732303335     0.001300321685886
 -90.000000000000000     9.931938267696671     0.001300321685886
 -90.000000000000000   170.068061732303335     0.001300321685886
  90.000000000000000    80.068061732303320     0.001300321685886
  90.000000000000000    99.931938267696694     0.001300321685886
 -90.000000000000000    80.068061732303320     0.001300321685886
 -90.000000000000000    99.931938267696694     0.001300321685886
  32.092443961164115    41.469303792449097     0.001842866472905
  32.092443961164115   138.530696207550932     0.001842866472905
 -32.092443961164115    41.469303792449097     0.001842866472905
 -32.092443961164115   138.530696207550932     0.001842866472905
 147.907556038835878    41.469303792449097     0.001842866472905
 147.907556038835878   138.530696207550932     0.001842866472905
-147.907556038835878    41.469303792449097     0.001842866472905
-147.907556038835878   138.530696207550932     0.001842866472905
  53.176943471957848    69.400829731786843     0.001842866472905
  53.176943471957848   110.599170268213172     0.001842866472905
 -53.176943471957848    69.400829731786843     0.001842866472905
 -53.176943471957848   110.599170268213172     0.001842866472905
 126.823056528042144    69.400829731786843     0.001842866472905
 126.823056528042144   110.599170268213172     0.001842866472905
-126.823056528042144    69.400829731786843     0.001842866472905
-126.823056528042144   110.599170268213172     0.001842866472905
  57.907556038835885    41.469303792449097     0.001842866472905
  57.907556038835885   138.530696207550932     0.001842866472905
 -57.907556038835885    41.469303792449097     0.001842866472905
 -57.907556038835885   138.530696207550932     0.001842866472905
 122.092443961164108    41.469303792449097     0.001842866472905
 122.092443961164108   138.530696207550932     0.001842866472905
-122.092443961164108    41.469303792449097     0.001842866472905
-122.092443961164108   138.530696207550932     0.001842866472905
  64.848267934007310    55.873191425684368     0.001842866472905
  64.848267934007310   124.126808574315618     0.001842866472905
 -64.848267934007310    55.873191425684368     0.001842866472905
 -64.848267934007310   124.126808574315618     0.001842866472905
 115.151732065992690    55.873191425684368     0.001842866472905
 115.151732065992690   124.126808574315618     0.001842866472905
-115.151732065992690    55.873191425684368     0.001842866472905
-115.151732065992690   124.126808574315618     0.001842866472905
  36.823056528042152    69.400829731786843     0.001842866472905
  36.823056528042152   110.599170268213172     0.001842866472905
 -36.823056528042152    69.400829731786843     0.001842866472905
 -36.823056528042152   110.599170268213172     0.001842866472905
 143.176943471957856    69.400829731786843     0.001842866472905
 143.176943471957856   110.599170268213172     0.001842866472905
-143.176943471957856    69.400829731786843     0.001842866472905
-143.176943471957856   110.599170268213172     0.001842866472905
  25.151732065992690    55.873191425684368     0.001842866472905
  25.151732065992690   124.126808574315618     0.001842866472905
 -25.151732065992690    55.873191425684368     0.001842866472905
 -25.151732065992690   124.126808574315618     0.001842866472905
 154.848267934007310    55.873191425684368     0.001842866472905
 154.848267934007310   124.126808574315618     0.001842866472905
-154.848267934007310    55.873191425684368     0.001842866472905
-154.848267934007310   124.126808574315618     0.001842866472905
  29.055102317087837    32.854865386032508     0.001802658934377
  29.055102317087837   147.145134613967485     0.001802658934377
 -29.055102317087837    32.854865386032508     0.001802658934377
 -29.055102317087837   147.145134613967485     0.001802658934377
 150.944897682912170    32.854865386032508     0.001802658934377
 150.944897682912170   147.145134613967485     0.001802658934377
-150.944897682912170    32.854865386032508     0.001802658934377
-150.944897682912170   147.145134613967485     0.001802658934377
  60.553592279152021    74.723841320161910     0.001802658934377
  60.553592279152021   105.276158679838090     0.001802658934377
 -60.553592279152021    74.723841320161910     0.001802658934377
 -60.553592279152021   105.276158679838090     0.001802658934377
 119.446407720847972    74.723841320161910     0.001802658934377
 119.446407720847972   105.276158679838090     0.001802658934377
-119.446407720847972    74.723841320161910     0.001802658934377
-119.446407720847972   105.276158679838090     0.001802658934377
  60.944897682912163    32.854865386032508     0.001802658934377
  60.944897682912163   147.145134613967485     0.001802658934377
 -60.944897682912163    32.854865386032508     0.001802658934377
 -60.944897682912163   147.145134613967485     0.001802658934377
 119.055102317087844    32.854865386032508     0.001802658934377
 119.055102317087844   147.145134613967485     0.001802658934377
-119.055102317087844    32.854865386032508     0.001802658934377
-119.055102317087844   147.145134613967485     0.001802658934377
  72.586540097930282    61.690168546968977     0.001802658934377
  72.586540097930282   118.309831453031052     0.001802658934377
 -72.586540097930282    61.690168546968977     0.001802658934377
 -72.586540097930282   118.309831453031052     0.001802658934377
 107.413459902069732    61.690168546968977     0.001802658934377
 107.413459902069732   118.309831453031052     0.001802658934377
-107.413459902069732    61.690168546968977     0.001802658934377
-107.413459902069732   118.309831453031052     0.001802658934377
  29.446407720847983    74.723841320161910     0.001802658934377
  29.446407720847983   105.276158679838090     0.001802658934377
 -29.446407720847983    74.723841320161910     0.001802658934377
 -29.446407720847983   105.276158679838090     0.001802658934377
 150.553592279152014    74.723841320161910     0.001802658934377
 150.553592279152014   105.276158679838090     0.001802658934377
-150.553592279152014    74.723841320161910     0.001802658934377
-150.553592279152014   105.276158679838090     0.001802658934377
  17.413459902069715    61.690168546968977     0.001802658934377
  17.413459902069715   118.309831453031052     0.001802658934377
 -17.413459902069715    61.690168546968977     0.001802658934377
 -17.413459902069715   118.309831453031052     0.001802658934377
 162.586540097930282    61.690168546968977     0.001802658934377
 162.586540097930282   118.309831453031052     0.001802658934377
-162.586540097930282    61.690168546968977     0.001802658934377
-162.586540097930282   118.309831453031052     0.001802658934377
  16.887062985325233    38.710048332216324     0.001849830560444
  16.887062985325233   141.289951667783697     0.001849830560444
 -16.887062985325233    38.710048332216324     0.001849830560444
 -16.887062985325233   141.289951667783697     0.001849830560444
 163.112937014674770    38.710048332216324     0.001849830560444
 163.112937014674770   141.289951667783697     0.001849830560444
-163.112937014674770    38.710048332216324     0.001849830560444
-163.112937014674770   141.289951667783697     0.001849830560444
  52.516110098206475    79.533296983429310     0.001849830560444
  52.516110098206475   100.466703016570690     0.001849830560444
 -52.516110098206475    79.533296983429310     0.001849830560444
 -52.516110098206475   100.466703016570690     0.001849830560444
 127.483889901793532    79.533296983429310     0.001849830560444
 127.483889901793532   100.466703016570690     0.001849830560444
-127.483889901793532    79.533296983429310     0.001849830560444
-127.483889901793532   100.466703016570690     0.001849830560444
  73.112937014674785    38.710048332216324     0.001849830560444
  73.112937014674785   141.289951667783697     0.001849830560444
 -73.112937014674785    38.710048332216324     0.001849830560444
 -73.112937014674785   141.289951667783697     0.001849830560444
 106.887062985325230    38.710048332216324     0.001849830560444
 106.887062985325230   141.289951667783697     0.001849830560444
-106.887062985325230    38.710048332216324     0.001849830560444
-106.887062985325230   141.289951667783697     0.001849830560444
  76.894583890113822    53.243703548729755     0.001849830560444
  76.894583890113822   126.756296451270245     0.001849830560444
 -76.894583890113822    53.243703548729755     0.001849830560444
 -76.894583890113822   126.756296451270245     0.001849830560444
 103.105416109886193    53.243703548729755     0.001849830560444
 103.105416109886193   126.756296451270245     0.001849830560444
-103.105416109886193    53.243703548729755     0.001849830560444
-103.105416109886193   126.756296451270245     0.001849830560444
  37.483889901793525    79.533296983429310     0.001849830560444
  37.483889901793525   100.466703016570690     0.001849830560444
 -37.483889901793525    79.533296983429310     0.001849830560444
 -37.483889901793525   100.466703016570690     0.001849830560444
 142.516110098206468    79.533296983429310     0.001849830560444
 142.516110098206468   100.466703016570690     0.001849830560444
-142.516110098206468    79.533296983429310     0.001849830560444
-142.516110098206468   100.466703016570690     0.001849830560444
  13.105416109886178    53.243703548729755     0.001849830560444
  13.105416109886178   126.756296451270245     0.001849830560444
 -13.105416109886178    53.243703548729755     0.001849830560444
 -13.105416109886178   126.756296451270245     0.001849830560444
 166.894583890113836    53.243703548729755     0.001849830560444
 166.894583890113836   126.756296451270245     0.001849830560444
-166.894583890113836    53.243703548729755     0.001849830560444
-166.894583890113836   126.756296451270245     0.001849830560444
  24.413852586150139    24.603115092281133     0.001713904507107
  24.413852586150139   155.396884907718885     0.001713904507107
 -24.413852586150139    24.603115092281133     0.001713904507107
 -24.413852586150139   155.396884907718885     0.001713904507107
 155.586147413849886    24.603115092281133     0.001713904507107
 155.586147413849886   155.396884907718885     0.001713904507107
-155.586147413849886    24.603115092281133     0.001713904507107
-155.586147413849886   155.396884907718885     0.001713904507107
  67.365929251013370    80.091251045140552     0.001713904507107
  67.365929251013370    99.908748954859462     0.001713904507107
 -67.365929251013370    80.091251045140552     0.001713904507107
 -67.365929251013370    99.908748954859462     0.001713904507107
 112.634070748986630    80.091251045140552     0.001713904507107
 112.634070748986630    99.908748954859462     0.001713904507107
-112.634070748986630    80.091251045140552     0.001713904507107
-112.634070748986630    99.908748954859462     0.001713904507107
  65.586147413849872    24.603115092281133     0.001713904507107
  65.586147413849872   155.396884907718885     0.001713904507107
 -65.586147413849872    24.603115092281133     0.001713904507107
 -65.586147413849872   155.396884907718885     0.001713904507107
 114.413852586150128    24.603115092281133     0.001713904507107
 114.413852586150128   155.396884907718885     0.001713904507107
-114.413852586150128    24.603115092281133     0.001713904507107
-114.413852586150128   155.396884907718885     0.001713904507107
  79.282851757880067    67.721835036985098     0.001713904507107
  79.282851757880067   112.278164963014916     0.001713904507107
 -79.282851757880067    67.721835036985098     0.001713904507107
 -79.282851757880067   112.278164963014916     0.001713904507107
 100.717148242119933    67.721835036985098     0.001713904507107
 100.717148242119933   112.278164963014916     0.001713904507107
-100.717148242119933    67.721835036985098     0.001713904507107
-100.717148242119933   112.278164963014916     0.001713904507107
  22.634070748986620    80.091251045140552     0.001713904507107
  22.634070748986620    99.908748954859462     0.001713904507107
 -22.634070748986620    80.091251045140552     0.001713904507107
 -22.634070748986620    99.908748954859462     0.001713904507107
 157.365929251013398    80.091251045140552     0.001713904507107
 157.365929251013398    99.908748954859462     0.001713904507107
-157.365929251013398    80.091251045140552     0.001713904507107
-157.365929251013398    99.908748954859462     0.001713904507107
  10.717148242119929    67.721835036985098     0.001713904507107
  10.717148242119929   112.278164963014916     0.001713904507107
 -10.717148242119929    67.721835036985098     0.001713904507107
 -10.717148242119929   112.278164963014916     0.001713904507107
 169.282851757880081    67.721835036985098     0.001713904507107
 169.282851757880081   112.278164963014916     0.001713904507107
-169.282851757880081    67.721835036985098     0.001713904507107
-169.282851757880081   112.278164963014916     0.001713904507107
  16.466282972742803    16.843047005921569     0.001555213603397
  16.466282972742803   163.156952994078438     0.001555213603397
 -16.466282972742803    16.843047005921569     0.001555213603397
 -16.466282972742803   163.156952994078438     0.001555213603397
 163.533717027257211    16.843047005921569     0.001555213603397
 163.533717027257211   163.156952994078438     0.001555213603397
-163.533717027257211    16.843047005921569     0.001555213603397
-163.533717027257211   163.156952994078438     0.001555213603397
  73.810850338833916    85.288978840333144     0.001555213603397
  73.810850338833916    94.711021159666856     0.001555213603397
 -73.810850338833916    85.288978840333144     0.001555213603397
 -73.810850338833916    94.711021159666856     0.001555213603397
 106.189149661166084    85.288978840333144     0.001555213603397
 106.189149661166084    94.711021159666856     0.001555213603397
-106.189149661166084    85.288978840333144     0.001555213603397
-106.189149661166084    94.711021159666856     0.001555213603397
  73.533717027257211    16.843047005921569     0.001555213603397
  73.533717027257211   163.156952994078438     0.001555213603397
 -73.533717027257211    16.843047005921569     0.001555213603397
 -73.533717027257211   163.156952994078438     0.001555213603397
 106.466282972742803    16.843047005921569     0.001555213603397
 106.466282972742803   163.156952994078438     0.001555213603397
-106.466282972742803    16.843047005921569     0.001555213603397
-106.466282972742803   163.156952994078438     0.001555213603397
  85.095387091867423    73.867039203468067     0.001555213603397
  85.095387091867423   106.132960796531947     0.001555213603397
 -85.095387091867423    73.867039203468067     0.001555213603397
 -85.095387091867423   106.132960796531947     0.001555213603397
  94.904612908132592    73.867039203468067     0.001555213603397
  94.904612908132592   106.132960796531947     0.001555213603397
 -94.904612908132592    73.867039203468067     0.001555213603397
 -94.904612908132592   106.132960796531947     0.001555213603397
  16.189149661166098    85.288978840333144     0.001555213603397
  16.189149661166098    94.711021159666856     0.001555213603397
 -16.189149661166098    85.288978840333144     0.001555213603397
 -16.189149661166098    94.711021159666856     0.001555213603397
 163.810850338833916    85.288978840333144     0.001555213603397
 163.810850338833916    94.711021159666856     0.001555213603397
-163.810850338833916    85.288978840333144     0.001555213603397
-163.810850338833916    94.711021159666856     0.001555213603397
   4.904612908132545    73.867039203468067     0.001555213603397
   4.904612908132545   106.132960796531947     0.001555213603397
  -4.904612908132545    73.867039203468067     0.001555213603397
  -4.904612908132545   106.132960796531947     0.001555213603397
 175.095387091867451    73.867039203468067     0.001555213603397
 175.095387091867451   106.132960796531947     0.001555213603397
-175.095387091867451    73.867039203468067     0.001555213603397
-175.095387091867451   106.132960796531947     0.001555213603397
  10.136472413382769    30.752975706205614     0.001802239128009
  10.136472413382769   149.247024293794396     0.001802239128009
 -10.136472413382769    30.752975706205614     0.001802239128009
 -10.136472413382769   149.247024293794396     0.001802239128009
 169.863527586617238    30.752975706205614     0.001802239128009
 169.863527586617238   149.247024293794396     0.001802239128009
-169.863527586617238    30.752975706205614     0.001802239128009
-169.863527586617238   149.247024293794396     0.001802239128009
  59.641618035752018    84.836849782060909     0.001802239128009
  59.641618035752018    95.163150217939091     0.001802239128009
 -59.641618035752018    84.836849782060909     0.001802239128009
 -59.641618035752018    95.163150217939091     0.001802239128009
 120.358381964247982    84.836849782060909     0.001802239128009
 120.358381964247982    95.163150217939091     0.001802239128009
-120.358381964247982    84.836849782060909     0.001802239128009
-120.358381964247982    95.163150217939091     0.001802239128009
  79.863527586617252    30.752975706205614     0.001802239128009
  79.863527586617252   149.247024293794396     0.001802239128009
 -79.863527586617252    30.752975706205614     0.001802239128009
 -79.863527586617252   149.247024293794396     0.001802239128009
 100.136472413382762    30.752975706205614     0.001802239128009
 100.136472413382762   149.247024293794396     0.001802239128009
-100.136472413382762    30.752975706205614     0.001802239128009
-100.136472413382762   149.247024293794396     0.001802239128009
  84.021920478040968    59.777691011721402     0.001802239128009
  84.021920478040968   120.222308988278613     0.001802239128009
 -84.021920478040968    59.777691011721402     0.001802239128009
 -84.021920478040968   120.222308988278613     0.001802239128009
  95.978079521959032    59.777691011721402     0.001802239128009
  95.978079521959032   120.222308988278613     0.001802239128009
 -95.978079521959032    59.777691011721402     0.001802239128009
 -95.978079521959032   120.222308988278613     0.001802239128009
  30.358381964247979    84.836849782060909     0.001802239128009
  30.358381964247979    95.163150217939091     0.001802239128009
 -30.358381964247979    84.836849782060909     0.001802239128009
 -30.358381964247979    95.163150217939091     0.001802239128009
 149.641618035752032    84.836849782060909     0.001802239128009
 149.641618035752032    95.163150217939091     0.001802239128009
-149.641618035752032    84.836849782060909     0.001802239128009
-149.641618035752032    95.163150217939091     0.001802239128009
   5.978079521959015    59.777691011721402     0.001802239128009
   5.978079521959015   120.222308988278613     0.001802239128009
  -5.978079521959015    59.777691011721402     0.001802239128009
  -5.978079521959015   120.222308988278613     0.001802239128009
 174.021920478040983    59.777691011721402     0.001802239128009
 174.021920478040983   120.222308988278613     0.001802239128009
-174.021920478040983    59.777691011721402     0.001802239128009
-174.021920478040983   120.222308988278613     0.001802239128009
"""

def QuickRadial(N,A=1., TwoD=False):
    x,wx = leggauss(N)
    x = (1.+x)/2.
    wx = wx/2.
    
    r = -A*np.log(1.-x)
    if TwoD:
        wr = r * A*wx/(1.-x)
    else:
        wr = (4.*np.pi*r**2) * A*wx/(1.-x)

    return r, wr

def vLen(x): return np.sqrt(np.sum(np.array(x)**2))
def vNorm(x): return np.array(x, dtype="float")/vLen(x)

class LebGridHelper:
    def __init__(self, LebQual = 41):
        if LebQual==25:
            self.NLeb = 230
            F = Leb25_Str.split('\n')
        if LebQual==41:
            self.NLeb = 590
            F = Leb41_Str.split('\n')
        else:
            self.NLeb = 38
            F = Leb9_Str.split('\n')
            
        self.xyz = np.zeros((self.NLeb,3))
        self.w = np.zeros((self.NLeb,))

        k=0
        for L in F:
            x=L.split()
            if len(x)>1:
                th = float(x[0])*np.pi/180.
                ph = float(x[1])*np.pi/180.

                self.xyz[k,:] = [ np.cos(th)*np.sin(ph),
                                  np.sin(th)*np.sin(ph),
                                  np.cos(ph) ]
                self.w[k] = float(x[2])

                k+=1
    def Grid3D(self, r, wr,
               HasScale=True,
               Prepend0=False):
        if len(wr)!=len(r):
            print("Different lengths for r and wr")
            quit()

        if not(HasScale):
            wwr = wr*(4.*np.pi*r**2)
        else: wwr=wr

        Nr = len(r)

        Grid_xyz = np.zeros((Nr, self.NLeb, 3))
        Grid_w   = np.zeros((Nr, self.NLeb))
        rIndx = np.zeros((Nr, self.NLeb), dtype=int)
        for i in range(Nr):
            Grid_xyz[i,:,:] = r[i]*self.xyz
            Grid_w[i,:] = wwr[i]*self.w
            rIndx[i,:] = i

        if not(Prepend0):
            self.xyz3D, self.w3D = Grid_xyz.reshape((-1,3)), Grid_w.reshape((-1,))
            self.rIndx = rIndx.reshape((-1,))
        else:
            A = Grid_xyz.reshape((-1,3))
            B = Grid_w.reshape((-1))
            self.xyz3D, self.w3D = np.vstack(([0,0,0],A)), np.hstack(([0],B))
            self.rIndx = np.hstack(([-1],rIndx.reshape((-1,))))

        self.Prepend0 = Prepend0
        self.r = r*1.
        self.wwr = wwr*1.
        self.wr = self.wwr/(4.*np.pi*self.r**2)

        return self.xyz3D, self.w3D

    def Grid3DGL(self, N=30, A=1.,
                 Prepend0=False):
        r,wr=QuickRadial(N, A)
        return self.Grid3D(r, wr, Prepend0=Prepend0, HasScale=True)

    def GridProject(self, rho):
        rhor = 0.*self.r
        for i in range(len(rhor)):
            wp = self.w3D[self.rIndx==i]
            rhop = rho[self.rIndx==i]
            rhor[i] = np.dot(wp, rhop)/np.sum(wp)
        return self.r, self.wwr, rhor

class LineGridHelper:
    def __init__(self, X1=[0,0,0], X2=[1,0,0], N=101, i0=0, X0=None):
        self.X1 = np.array(X1)
        self.X2 = np.array(X2)

        self.xyz = np.zeros((N+1,3))
        for n in range(N):
            a = n/(N-1.)
            self.xyz[n+1,:] = (1.-a)*self.X1 + a*self.X2

        if X0 is None:
            self.xyz[0,:] = self.xyz[i0,:]
        else:
            self.xyz[0,:] = np.array(X0)

    def UpdateX0(self, X0): self.xyz[0,:] = np.array(X0)
    
    def Grid3D(self): return self.xyz

class CylGridHelper:
    def __init__(self, z0=[0,0,-4], z1=[0,0,4],
                 Ar = 2., Nr = 31,
                 Nz = 81, Ntheta=21):
        # The end points
        self.z0 = np.array(z0)
        self.z1 = np.array(z1)
        dz = vLen(self.z1-self.z0)
        
        # The 'z' direction
        self.kh = vNorm(self.z1-self.z0)

        # Set up 'i' and 'j'
        i0 = np.array([1.,0,0])
        if np.abs(np.dot(i0, self.kh))<1e-5:
            i0 = np.array([0,1.,0])

        i0 -= np.dot(self.kh,i0) 
        self.ih = vNorm(i0)
        self.jh = np.cross(self.kh, self.ih)

        self.t,self.wt = leggauss(Ntheta)
        self.t*=np.pi
        self.wt*=np.pi
        self.r,self.wr = QuickRadial(Nr, Ar, TwoD = True)
        
        f = np.linspace(0.,1., Nz)
        self.z = f*dz
        self.wz = np.mean(np.diff(f))*dz

        self.z3d = np.outer((1.-f),self.z0) + np.outer(f,self.z1)

        self.Ntheta = Ntheta
        self.Nr = Nr
        self.Nz = Nz

        self.FullShape = (self.Ntheta, self.Nr, self.Nz)

        self.xyz = np.zeros(list(self.FullShape)+[3])
        self.w = np.zeros(self.FullShape)
        self.wrz = np.zeros((self.Nr, self.Nz,))
        for k in range(Ntheta):
            for l in range(Nr):
                indx0 = (k*Nr+l)*Nz
                indxf = indx0 + Nz

                r0 = self.r[l]*(np.cos(self.t[k])*self.ih + np.sin(self.t[k])*self.jh)

                self.w[k,l,:] = self.wt[k]*self.wr[l]*self.wz
                self.wrz[l,:] = 2.*np.pi * self.r[l] * self.wr[l]*self.wz
                self.xyz[k,l,:,:] = self.z3d + r0

        self.xyz = self.xyz.reshape((-1,3))
        self.w = self.w.reshape((-1,))
        
    def GetGrid(self):
        return self.xyz, self.w
    
    def Project2D(self, F):
        return np.einsum('ij,i->ij',
                         np.tensordot(
                             self.wt, F.reshape((self.Ntheta,self.Nr,self.Nz)),
                             axes=((0,),(0,))),
                         1. / (2.*np.pi * self.r))

    def ProjectZ(self, F):
        return np.einsum('ijk,ijk->i', self.w.reshape(self.FullShape),
                         F.reshape(self.FullShape))/self.wz

    def ProjectR(self, F):
        return np.dot(self.w, self.Project2D(F).reshape((self.Nr,-1)))


if __name__ == "__main__":
    CylGrid = CylGridHelper()
    xyz = CylGrid.xyz
    F = np.exp(-0.5*(xyz[:,0]**2 + xyz[:,1]**2 + xyz[:,2]**2))
    F1D = CylGrid.Project1D(F)
    print(F1D/np.exp(-0.5*xyz[:81,2]**2))
    
    LineGrid = LineGridHelper()
    print(LineGrid.Grid3D())


    Leb9Grid = LebGridHelper()
    
    r, wr = QuickRadial(30)
    xyz, w = Leb9Grid.Grid3D(r, wr, Prepend0=True)

    print(xyz.shape, w.shape)
    print(xyz[0,:])

    rho = 1./np.pi * np.exp( -2.* np.sqrt(np.sum(xyz**2,axis=1)))
    print(np.dot(w, rho))


